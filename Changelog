powerpc-utils-1.3.3
=====================================================================

commit d63e12aa7cd22d5e6c2baf595aacb644311e0217
Author: Mamatha Inamdar <mamatha4@linux.vnet.ibm.com>
Date:   Tue Dec 6 11:36:57 2016 -0500

    nvram:read list of partion names dynamically
    
    This patch is to read "list of partition dynamically and
    use it rather than having hardcoded partition table list.
    
    Test Results:
    
    without patch:
    nvram: ERROR: There is no Open Firmware "ibm,skiboot" partition!
    
    with patch:
    "ibm,skiboot" Partition
    --------------------------
    experimental-fast-reset=feeling-lucky
    
    Signed-off-by: Mamatha Inamdar <mamatha4@linux.vnet.ibm.com>
    Tested-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>

commit b54a095e820d0163e29b76b517b57227a358950d
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Dec 6 11:29:17 2016 -0500

    lsslot: Correct formatting fopr printing cpus and caches
    
    Minor updates to the field sizes when printing cpus and caches
    so that the fields no longer run together.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 9d363cd79315f08d00e63674b3608dd3fdd72939
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Dec 6 11:16:14 2016 -0500

    lsslot: Validate cpu->name when printing
    
    When printing the information for all possible CPUs we can possibly print
    a NULL string pointer. the libc printf code handles this gracefully by
    printing '(NULL)' but this is not what we should be relying on.
    
    This validates the cpu->name pointer before printing it and instead
    prints '--' if cpu->name is not valid.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit b3b35e9a84913f98ab1abf8ac019c8f3a94a5e1d
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Dec 6 11:12:06 2016 -0500

    lsslot: Allow printing information of all possible cpus
    
    The lsslot command gathers information about all possible cpus on a
    system but only prints information about cpus that are present. This
    patch adds the ability to print information about all possible cpus
    when the '-d 4' option is used.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 8b229153221416bfdcd06ef67ad3a18fb5bea171
Author: Michel Normand <normand@linux.vnet.ibm.com>
Date:   Tue Dec 6 11:03:00 2016 -0500

    ofpathname: Avoid infinit loop in get_slave()
    
    This is a bypass for a problem raised on openSUSE with bug
    https://bugzilla.suse.com/show_bug.cgi?id=1011529
    
    Signed-off-by: Michel Normand <normand@linux.vnet.ibm.com>

commit 944cc93ae316edc99bbac1a83f5b0e1aa9401657
Author: Paul A. Clarke <pc@us.ibm.com>
Date:   Thu Dec 1 11:05:25 2016 -0500

    ppc64_cpu: emit error message for invalid core number to on- or offline
    
    An off-by-one test is done to detect invalid core numbers for explicit
    online/offline.  For example, on a 16 core system, valid cores are 0-15.
    However, specifying "16" has no effect, but does not produce an error:
    --
     # ./src/ppc64_cpu --cores-on
     Number of cores online = 15
     # ppc64_cpu --online-cores=16
     # ppc64_cpu --online-cores=17
     Invalid core to online: 17
    --
    
    This change will correctly report an error:
    --
     # ppc64_cpu --online-cores=16
     Invalid core to online: 16
    --
    
    Signed-off-by: Paul A. Clarke <pc@us.ibm.com>

commit be7583177b845b69b7c2e1f21f2652c0545c996d
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Nov 29 11:42:37 2016 -0500

    lsprop: Update and honor recurse option
    
    The -R (recurse) option to lsprop is not honored when dumping the contents
    of a directory. Update the option to also include --recurse and honor this
    option when specified.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 69b62ea770c6f84f91706d8610a2815fbb19decc
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Nov 29 11:41:27 2016 -0500

    lsprop: Add command version
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit ab587974c47f3c45929c748a16eee33e875c53f3
Author: Paul A. Clarke <pc@us.ibm.com>
Date:   Tue Nov 29 11:33:54 2016 -0500

    ppc64_cpu: tolerate non-uniform per-core SMT mode
    
    If not every core is in the same SMT state, the ppc64_cpu command will
    report such and no information specific to the command request:
    --
     # ppc64_cpu --cores-on
     Bad or inconsistent SMT state: use ppc64_cpu --smt=on|off to set all
     cores to have the same number of online threads to continue.
     Core   0:    0*    1*    2*    3*
     Core   1:    4*    5*    6*    7*
     Core   2:    8*    9*   10*   11*
     Core   3:   12*   13*   14*   15*
     Core   4:   16*   17*   18*   19*
     Core   5:   20*   21*   22*   23*
     Core   6:   24*   25*   26*   27*
     Core   7:   28*   29*   30*   31*
     Core   8:   32*   33    34    35
     Core   9:   36*   37    38    39
     Core  10:   40*   41*   42*   43*
     Core  11:   44*   45*   46    47
     Core  12:   48*   49*   50*   51*
     Core  13:   52    53    54*   55*
     Core  14:   56    57    58    59
     Core  15:   60*   61*   62*   63
     # ppc64_cpu --online-cores
     Bad or inconsistent SMT state: use ppc64_cpu --smt=on|off to set all
     cores to have the same number of online threads to continue.
     Core   0:    0*    1*    2*    3*
     Core   1:    4*    5*    6*    7*
     Core   2:    8*    9*   10*   11*
     Core   3:   12*   13*   14*   15*
     Core   4:   16*   17*   18*   19*
     Core   5:   20*   21*   22*   23*
     Core   6:   24*   25*   26*   27*
     Core   7:   28*   29*   30*   31*
     Core   8:   32*   33    34    35
     Core   9:   36*   37    38    39
     Core  10:   40*   41*   42*   43*
     Core  11:   44*   45*   46    47
     Core  12:   48*   49*   50*   51*
     Core  13:   52    53    54*   55*
     Core  14:   56    57    58    59
     Core  15:   60*   61*   62*   63
     # ppc64_cpu --offline-cores
     Bad or inconsistent SMT state: use ppc64_cpu --smt=on|off to set all
     cores to have the same number of online threads to continue.
     Core   0:    0*    1*    2*    3*
     Core   1:    4*    5*    6*    7*
     Core   2:    8*    9*   10*   11*
     Core   3:   12*   13*   14*   15*
     Core   4:   16*   17*   18*   19*
     Core   5:   20*   21*   22*   23*
     Core   6:   24*   25*   26*   27*
     Core   7:   28*   29*   30*   31*
     Core   8:   32*   33    34    35
     Core   9:   36*   37    38    39
     Core  10:   40*   41*   42*   43*
     Core  11:   44*   45*   46    47
     Core  12:   48*   49*   50*   51*
     Core  13:   52    53    54*   55*
     Core  14:   56    57    58    59
     Core  15:   60*   61*   62*   63
     # ppc64_cpu --smt
     Inconsistent state: mix of ST and SMT cores
    --
    
    This change allows the ppc64_cpu command to properly respond to the above
    requests:
    --
     # ppc64_cpu --cores-on
     Number of cores online = 15
     # ppc64_cpu --online-cores
     Cores online = 0,1,2,3,4,5,6,7,8,9,10,11,12,13,15
     # ppc64_cpu --offline-cores
     Cores offline = 14
     # ppc64_cpu --smt
     SMT=1: 8-9
     SMT=2: 11,13
     SMT=3: 15
     SMT=4: 0-7,10,12
    --
    
    Note that the output for "--smt" only changes if there is mixed modes.
    If the mode is uniform, the output will remain as before:
     # ppc64_cpu --smt=4
     # ppc64_cpu --smt
     SMT=4
    
    Signed-off-by: Paul A. Clarke <pc@us.ibm.com>

commit e227a80df7643a1f45e0d2b06e56ef430772c2dd
Author: Breno Leitao <breno.leitao@gmail.com>
Date:   Tue Nov 22 12:22:45 2016 -0500

    ppc64_cpu: add a numeric option when printing SMT
    
    Currently, there is not a numeric (non verbose) display of SMT modes,
    which means that three verbose output is usually generated, as:
    
      SMT=X
      SMT is off
      Machine is not SMT capable
    
    This patch implements a easily machine parsable output for SMT, helping
    a lot of scripts that needs to read SMT status on a machine.
    
    I am considering that if the SMT is off or impossible, then SMT=1 (1
    thread per core), thus, always returning SMT=X, where X means thread
    enabled per core, as 1, 2, 4, 8.
    
    Signed-off-by: Breno Leitao <breno.leitao@gmail.com>

commit 09b36b64ec51bd8ce6c0b2b345974cb228064b89
Author: Breno Leitao <breno.leitao@gmail.com>
Date:   Tue Nov 22 12:16:35 2016 -0500

    Fix man page for ppc64_cpu
    
    Currently there is a typo on ppc64_cpu manpage which causes the text
    to be corrupted, not printing anything after this typo, as showed:
    
           --smt  Display the current smt setting for  the  system.  The
                  .....
                  threads online varies per core, or
    
    As you can see, there is nothing else after the ", or" expression.
    
    This patch simply fixes this typo, which makes the manpage render
    correctly.
    
    Signed-off-by: Breno Leitao <breno.leitao@gmail.com>
    Reviewed-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>

commit 59a17aac4728a3c060f128b315df1324b8df39f5
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Nov 22 11:43:20 2016 -0500

    lprstat: Add command version
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>
    Reviewed-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>

commit 4519274c0bdbd781f660a1df8ca41cbe267229e4
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Nov 22 11:42:15 2016 -0500

    activate_firmware: Remove extraneous comments
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 7e9a53937469c451de78d321abe64434ce3e0731
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Nov 22 11:41:12 2016 -0500

    activate_firmware: Add verbose output option
    
    The activate_firmware currently has some debug statements that can only
    be activated by building the command with DEBUG defined. Instead, we should
    always have these statements active and control their output with the
    -v, --verbose option.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 2b0867d3327442fa8bcb42269db3436b5507ac2f
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Nov 22 11:40:09 2016 -0500

    activate_firmware: Update the usage message and option parsing
    
    The usage message for activate_firmware should limit itself to 80
    characters per line. Additionally the formatting could use a little
    updating now that we have long options.
    
    The new help message appears as:
    
    Usage: src/activate_firmware [-e [keyfile]]
    Without any option, the activate_firmware utility will cause a firmware image
    that has already been flashed to be activated concurrently.
    
    Option summary:
      -e             prints the current Update Access Key expiry date
      -e <keyfile>   applies the provided Update Access key-file to extend
                     the service expiry date
      -h, --help     print this message.
      -v, --verbose  output extra debug information
      -V, --version  print version information.
    
    This patch also allows users to specify --help in addition -h for
    the help option.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>
    Reviewed-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>

commit 1c4f7810323f3859f0359250eb3a6f4fab4ff036
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Nov 22 11:38:42 2016 -0500

    activate_firmware: Add versioning
    
    Add versioning to the activate_firmware command.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>
    Reviewed-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
    Reviewed-by: Tyrel Datwyler <tyreld@linux.vnet.ibm.com>

commit 06f2033866b2a991def24354e8657c8146c43b95
Author: Breno Leitao <breno.leitao@gmail.com>
Date:   Wed Nov 9 16:24:22 2016 -0500

    Fix endian.h header on FreeBSD
    
    Unfortunately Linux default endian.h is locaed in sys/endian.h on
    FreeBSD. This patch simply detect what system you are running and
    use the proper location on the include.
    
    Signed-off-by: Breno Leitao <breno.leitao@gmail.com>

commit 28ec98068a3d06e77d8d3496c26e2f4ff8e61aeb
Author: Breno Leitao <breno.leitao@gmail.com>
Date:   Wed Nov 9 16:23:10 2016 -0500

    Avoid linking with libdl on BSD systems
    
    FreeBSD does not have libdl, so, when linking with -ldl fails.
    This patch simply check if you are running on BSD, and does not
    invoke -ldl during compilation.
    
    Signed-off-by: Breno Leitao <breno.leitao@gmail.com>

commit eca0c56ab6b041c1c90aa213492121d6f0d0c6af
Author: Breno Leitao <breno.leitao@gmail.com>
Date:   Wed Nov 9 16:20:20 2016 -0500

    ppc64_cpu: Fix function method signature
    
    If HAVE_LINUX_PERF_EVENT_H is not defined, the code fails to
    compile, because function do_cpu_frequency() does not have an
    Argument, as it has if HAVE_LINUX_PERF_EVENT_H is defined.
    This is the error message:
    
     error: too many arguments to function 'do_cpu_frequency'
    
    This patch simply adds an argument to the function.
    
    Signed-off-by: Breno Leitao <breno.leitao@gmail.com>

commit 741054926742785290ed1cfacac04d8e55409b4a
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Wed Oct 19 10:40:25 2016 -0400

    .gitignore: Add errinjct and rtas_dbg executables
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit d42164cd2dde616ba51b4143d9c17aa0b9c40b4a
Author: Hariharan T.S <hari@linux.vnet.ibm.com>
Date:   Wed Oct 19 10:37:51 2016 -0400

    hvcsadmin: findtools should be called before is_driver installed
    
    scripts/hvcsadmin: is_driver_installed is using systools, where as the
    same is checked for existence in findtools which is called later. It has
    to be called before to get the proper error message.
    
    The patch will first check for systools before checking for drivers.
    
    It will avoid the following situation.
    
    hvcsadmin -status
    Can't exec "systool": No such file or directory at /usr/sbin/hvcsadmin line 272.
    systool: No such file or directory at /usr/sbin/hvcsadmin line 272.
    
    Signed-off-by: Hariharan T.S. <hari@linux.vnet.ibm.com>

commit 0947a3dbaed4fc02e7d2d19cb0cdc6059fb86d5b
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Wed Oct 19 10:35:09 2016 -0400

    drmgr: Cleanup unused progress states in acquiring hotplug resources
    
    The progress state that is updated throughout the process of acquiring
    a hotplug resource is not used anywhere. This patch removes it.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit e116eb625c5cb194cb8bd59ddf1564e5268e6b31
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Wed Oct 19 10:33:26 2016 -0400

    drmgr: Add capability for PCI hotplug only operations
    
    We need to provide the capability to do a hotplug only style of operation
    for some adapters such as nvme adapters behind a bridge that can be owned
    by more than one partition. These scenarios are used for doing failovers
    and this update reduces the total drmgr time from 18 seconds per add or
    remove down to 2-3 seconds per action.
    
    Note that this is different from the PAPR notion of hotplug where the
    device is hotplug removed from the OS, then the slot is powered down,
    a new card inserted, the slot powered up, and the device hootplug added
    back into the system. This is the drmgr -R action. This new functionality
    just does the hotplug to/from the OS, nothing else.
    
    This update assumes that when doing an add, the DR indicator already has
    the proper isolation and allocation state, and the power to the slot is
    on. For remove operations the indicator and power for the slot is not
    modified.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 071949595434f68c7ed722b932173d9f69c20c84
Author: Stephen E. Royer <seroyer@us.ibm.com>
Date:   Thu Sep 1 10:12:10 2016 -0400

    nvsetenv: Fix unitialized variable in 'hvcsadmin'
    
    scripts/hvcsadmin: Fix display of distracting perl script warning
    notice about an unitialized variable during execution.  The message
    is an annoyance during operation.
    
    Signed-off-by: Stephen E. Royer <seroyer@us.ibm.com>
    Signed-off-by: Michael Bringmann <mwb@linux.vnet.ibm.com>

commit 16d7b3126e0c73a1eeb94742559934034667e4c7
Author: Michael Bringmann <mwb@linux.vnet.ibm.com>
Date:   Thu Sep 1 10:09:15 2016 -0400

    nvsetenv: Fix rpmbuild inclusion for nvsetenv
    
    Update Makefile.am to add the nvsetenv command to sbin_SCRIPTS so that is
    is included in generated tarballs from 'make dist'.
    
    Signed-off-by: Michael Bringmann <mwb@linux.vnet.ibm.com>

commit b071e81d8cd71af496d5c5b36371c30449051def
Author: John Allen <jallen@linux.vnet.ibm.com>
Date:   Fri Aug 26 15:29:58 2016 -0400

    lparstat: Ignore whitespace at beginning of /proc/interrupts SPU line
    
    In the case that any interrupt number in /proc/interrupts exceeds 3
    characters, whitespace will be placed at the beginning of the SPU line in
    order to keep the columns aligned. In that case, the current code will miss
    the SPU line. This patch skips any whitespace preceding the SPU line.
    
    Signed-off-by: John Allen <jallen@linux.vnet.ibm.com>

commit ce767e7a7254e5dd38655b67e31a7b337df5d68e
Author: John Allen <jallen@linux.vnet.ibm.com>
Date:   Fri Aug 26 15:26:12 2016 -0400

    drmgr: Include GPL header in prrn.c
    
    Add GPL boilerplate to prrn.c for consistency with other files in
    powerpc-utils.
    
    Signed-off-by: John Allen <jallen@linux.vnet.ibm.com>

commit 5814722814f876d584f59afdb38e7d3f23e6c7ad
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Fri Aug 26 15:21:06 2016 -0400

    drmgr: Add options.c to Makefile for creating tarballs
    
    Previous updates that ctreated the file options.c that is #included
    instead of built directly for drmgr and lsslot did not update the Makefile
    to ensure this file is included in tarballs when doing a 'make dist'.
    
    Add options.c to the list of NOINST_HEADERS for drmgr and lsslot.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 5799f6f26c34b6e7ac200e50666188279704937c
Author: Michael Bringmann <mwb@linux.vnet.ibm.com>
Date:   Fri Aug 26 15:17:25 2016 -0400

    nvsetenv: Add nvsetenv from SUSE distro
    
    nvsetenv: Add the nvsetenv script to the package which is normally
    only present in the SuSE variant of powerpc-utils.  The script is
    a wrapper for the nvram utility.
    
    Signed-off-by: Michael Bringmann <mwb@linux.vnet.ibm.com>

commit 3c3a53825248e1ef52ee203c968f643c26820cc5
Author: John Allen <jallen@linux.vnet.ibm.com>
Date:   Tue Aug 23 11:23:31 2016 -0400

    lparstat: Fix segfault when parsing /proc/interrupts
    
    Fix a bug where we hit a segfault running 'lparstat -i' on machines with a
    large number of cpus. The 'SPU' line in proc interrupts would exceed the
    512B allocated and we would subsequently walk off the end of the array
    when we attempt to parse the line. This solution uses getline instead of
    fgets in order to easily handle lines of arbitrary length.
    
    Signed-off-by: John Allen <jallen@linux.vnet.ibm.com>

commit 0a93eb52603fc8ea77f69ae628f7634054363ad3
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Aug 23 10:41:39 2016 -0400

    drmgr: kill the options struct
    
    Remove the now empty struct options after making all of its members
    globals.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 64c57c69ed42c4a7af0e4d6b4657f0a52e608dfe
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:20:23 2016 -0400

    lsslot: Make struct options member delimiter global
    
    Make the struct options member delimiter global and re-name it to
    usr_delimiter.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit e82fb588f5738e6d51e7530b894233c190c588b8
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:19:04 2016 -0400

    lsslot: replace struct options member s_name with usr_drc_name
    
    With moving the option variables to globals we can replace the s_name
    lsslot variable with the existing usr_drc_name variable.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 4763b5452a120d6e7c98afcd24cc63e20e33f8de
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:17:40 2016 -0400

    lsslot: make struct options member p_flag global
    
    Make the struct options member p_flag global and re-name it to show_caches
    to make it more descriptive.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 3dde5f36a9c87b9944ad4f46b983ebd2292455d2
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:16:45 2016 -0400

    lsslot: make struct options member o_flag global
    
    Make the struct options member o_flag global and re-name it to
    show_occupied_slots to make it more descriptive.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 378acd01a6cc08e4afe27dd2aa102669cdf05f9b
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:15:52 2016 -0400

    lsslot: make struct options member b_flag global
    
    Make the struct options member b_flag global and rename it to
    show_cpus_and_caches to make it more descriptive of what it represents.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 1d43df2b2c8090073aaafdfdc2d43ff5f2bac1e0
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:14:54 2016 -0400

    lsslot: Make the struct options member a_flag global
    
    Make the struct options member a_flag a global variable and re-name it
    to show_available_slots to make it more descriptive of what it
    represents.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 67e7a1e02aa0b5223df32228311c8083e293ea8a
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:13:29 2016 -0400

    lsslot: remove struct options slot_type member
    
    With the combined options struct and global variables we can re-use the
    drc_type to replace the lsslot variable slot_type.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 1de7ad4c2952392d151e02f9a67835dcc479ee7c
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:10:34 2016 -0400

    drmgr: Make struct options member prrn_filename global
    
    Make the struct options member prrn_filename global.
    
    Signd-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 48b5de724e0baf7a74ec01cb983d2cd882510484
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:09:09 2016 -0400

    drmgr: Make struct options member pci_virtio global
    
    Make the struct options member pci_virtio a global variable.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 213da0d8933835f1ec9466498d1ac800a8c83f0f
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:07:25 2016 -0400

    drmgr: Make struct options member p_option global
    
    Make the struct options member p_option global as the variable
    usr_p_option.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit f9986ac430113c96d0398efb44159c22410bdf5f
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 16:02:09 2016 -0400

    drmgr: Move options.ctype to global usr_drc_type
    
    Move the ctype member of struct options out to be the global usr_drc_type.
    This also makes the usr_drc_type an enum drc_type.
    
    The type change to the enum allows for checking the type directly
    instead of the numerous strcmp() operations that are done.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit f74a63f87acd08d9391134de50673f0cf22734a4
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 15:52:56 2016 -0400

    drmgr: Make struct options member 'quantity' global
    
    Move the quantity member of struct options to be the global usr_drc_count.
    
    Signed-off-by: Nathan Fonteot <nfont@linux.vnet.ibm.com>

commit 0df871dd765933322ddbb63ff66e158ef81805dd
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 15:49:27 2016 -0400

    drmgr: Make options struct no_ident member global
    
    Move the no_ident member of struct options to be the global usr_prompt
    variable. This change also moves the variable to a positive connotation
    which makes the code slightly easier to read.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 8192b8e6a79d784038ca5fdb1fc7959149e7105b
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 15:45:58 2016 -0400

    drmgr: Make struct options member usr_drc_index global
    
    Move the usr_drc_index member of struct options to be global.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 669f581f4f65cb9046699ed7a375bc1693cdac92
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 15:42:48 2016 -0400

    drmgr: Make struct options member usr_drc_name global
    
    Move the usr_drc_name out of struct options to be global.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit d1a1ed2f4349838fa162c1ef0a6b903ed1b2b42a
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 15:37:55 2016 -0400

    drmgr: Make struct options member timeout global
    
    Move the timeout member of struct options out to be the global usr_timeout.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 552e42d863db093881d58038f27c5d2d72025491
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 15:35:41 2016 -0400

    drmgr: Make struct options member no_ident global
    
    Move the no_ident member out of struct options to become the global
    usr_slot_identification. This change also gives the variable a
    positive connotation instead of the current negative so we are not
    checking for not no_ident, this should make the code more readable.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 6b9908f6c59dc2c24bf71f89f809f11b7cdb7fd3
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 15:33:36 2016 -0400

    drmgr: Update various uses of local 'action' variable
    
    Update the various locations that use a local action variable and just
    use the global usr_action variable directly.
    
    Signed-off-by: Nathan Fonteot <nfont@linux.vnet.ibm.com>

commit 9606e3012efd2eb0c3c7be95ea43f66c517ef3bc
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 15:29:00 2016 -0400

    drmgr: Make option struct member 'action' global
    
    Move the action member out of struct options to become the global
    usr_action. Also introduce the enum drmgr_action as the type for
    usr_action.
    
    This patch also introduces the file options.c which will hold the
    definitions of all of the global variables common to the drmgr and
    lsslot commands. This file is included in drmgr.c and lsslot.c instead
    of being built directly.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit f3379e4bd9525a914f3e5478858de7425689a778
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Aug 22 15:22:42 2016 -0400

    drmgr: Merge drmgr and lsslot options structs
    
    Merge the lsslot cmd_opts struct in to the drmgr options struct to make
    a unified options structure for both commands.
    
    By also moving the MAX #define to dr.h we can get rid of the lsslot.h
    header.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit c61535c62111d04a886a2b4d7613b7006d5fe209
Author: John Allen <jallen@linux.vnet.ibm.com>
Date:   Thu Aug 11 16:30:12 2016 -0400

    lparstat: Fix bad cast from integer to float
    
    Fix a bug where the cpu stats (%user, %sys, %wait, and %idle) do not add
    up to 100%. The problem was that we were casting the cpu stats and the
    total cpu time to floats from ints. For large integer values, this would
    cause the floating point representation to be truncated. This solution
    avoids the casts and stores the cpu stats as long longs and only casts
    'total' to a long double in order to perform floating point division.
    
    Additionally, this patch parses the proc stat values as long longs as
    on systems that have been running for a long time, these values can exceed
    the maximum 32 bit integer limit.
    
    Signed-off-by: John Allen <jallen@linux.vnet.ibm.com>

powerpc-utils-1.3.2
=====================================================================
commit 4e5b9dacf7bbddfb58269fc50de6586a9ac6fdfd
Author: Ulrich Weigand <ulrich.weigand@de.ibm.com>
Date:   Mon Jul 11 17:13:17 2016 -0400

    lparstat: Fix computation of time used in statistics
    
    The routine get_time computes bogus timestap values due to confusing
    seconds and microseconds.  This leads to incorrect return values from
    elapsed_time and therefore incorrect values for the physc field.
    
    Fixed by converting the "time" sysentry field to microseconds (and
    computing it correctly), and updating the user of elapsed_time.
    
    In addition, %entc is supposed to show the ratio of physc to the
    number of entitled CPUs as *percentage*, so the ratio needs to be
    multiplied by 100.
    
    Signed-off-by: Ulrich Weigand <ulrich.weigand@de.ibm.com>
    Signed-off-by: Michael Bringmann <mbringm@us.ibm.com>

commit a97c5664f53f9a18dd0b941a842d7884253cf8ed
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Jul 11 17:06:26 2016 -0400

    drmgr: Disable use of in-kernel cpu hotplug
    
    After submitting the patch to update drmgr to use the in-kernel hotplug
    capabilities for memory and cpu, commit <bbc5fc07c54d> (drmgr: Start using
    in-kernel DLPAR functionality for cpu/memory), I realized there
    are still distro kernels that do not have the in-kernel cpu hotplug
    capabilities. Using the latest drmgr with this update breaks cpu dlpar
    because the cpu dlpar code assumes that if the dlpar sysfs file exists
    then in-kernel cpu dlpar is possible. this is wrong, the sysfs dlpar file
    was added with in-kernel memory hotplug, its existence can only guarantee
    memory hotplug capability.
    
    For now, disable using the in-kernel cpu capabilities by drmgr until
    this can be resolved.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 2bb7599d702d4e1de1ff0f9cbe53329e59c4e120
Author: Ian Neal <ian.neal@gmail.com>
Date:   Mon Jul 11 10:02:45 2016 -0400

    lparstat: flush data to stdout
    
    The stdout stream is not being flushed after being written to.  This
    means that it doesn't behave properly in shell pipelines as the data
    isn't visible until the program exits.  The fix is to simply flush
    after writes so the data is immediately available to other processes
    in the pipeline.
    
    Signed-off-by: Ian Neal <ian.neal@gmail.com>

commit c3269d4e3d4882fd931d1df6aece0bec86fb6734
Author: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
Date:   Thu Jun 30 10:26:58 2016 -0400

    update_flash: Fix bashism issue in opp_display_current_fw_version()
    
    Ubuntu uses dash, not bash. We hit below warning on Ubuntu system.
    
    root@abc:/sys/firmware/devicetree/base/ibm,opal/sensors# update_flash -d
    /usr/sbin/update_flash_nv: 595: [: x43: unexpected operator
    Firmware version:
    ....
    ....
    
    == is a bashism. Replace it with =.
    
    Fixes: 767e3dd7 (update_flash: Add support for OpenPower system)
    Signed-off-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>

commit 386a07c4dc6c09d35116dc6064f7a83d76f4415b
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue May 24 16:32:39 2016 -0400

    errinjct: Correct read_file() error checking
    
    When reading files from syfs the file length returned from a stat()
    call does not always match the actual length of the file. The read_file()
    routine should be checking for an error return from the read() call
    instead of checking that the amount read matches the file length returned
    from a stat() call.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 42b83884bfb51c0c8b23bf2949157430f8468caa
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue May 24 16:31:37 2016 -0400

    errinjct: Recognize -5 return from rtas
    
    Update the errinjct command to recognize the rturn code of -5 from
    rtas indicating that PCI error injection is not enabled.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit ab848a8d5cc4c4b9f5faef1b31be3982fb7d4bf2
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue May 24 16:30:33 2016 -0400

    errinjct: Correct config_addr parsing
    
    A recent patch (commit id: ccc9c72cec2a4) to move the errinjct function to
    using a common read_file() routine did not correctly update the
    get_config_addr_from_reg() function. This patch corrects this to return the
    proper config address.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 9fc079cf39d999040483a00d3b41000ca3e43013
Author: John Allen <jallen@linux.vnet.ibm.com>
Date:   Tue May 24 16:28:27 2016 -0400

    drmgr: Workaround for concurrent PRRN collisions
    
    Proposed workaround for issues with current PRRN event handling mechanism.
    
    Currently, the mechanism works by kicking off a script that calls a drmgr
    remove followed by a drmgr add for each effected device. With this method,
    problems can occur when multiple prrn events arrive in a short time span or
    when other dlpar operations are happening while the script is running. What
    can happen is that these other dlpar operations can jump in inbetween when
    the script calls the remove and the add and take the drmgr lock. Then when
    we try to add the memory back from the script, we are unable to take the
    drmgr lock and the add fails.
    
    This patch fixes this issue by creating a new -P flag for drmgr which will
    perform the necessary removes/adds from within the drmgr lock. The new
    option will be invoked as follows:
    
    drmgr -P <path to prrn log file>
    
    On the rtas_errd side, we will begin by creating a log file for the
    PRRN event which will contain a list of the type and the drc index for
    each effected device. Then instead of invoking the script, we will call
    the above drmgr command with the path to the prrn log file. Then, on the
    drmgr side, we parse the list and perform the necessary removes/adds and
    then delete the prrn log file.
    
    Signed-off-by: John Allen <jallen@linux.vnet.ibm.com>

commit bbc5fc07c54dd53f4ceac3552ea12717cc86cba2
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Wed May 11 13:16:19 2016 -0400

    drmgr: Start using in-kernel DLPAR functionality for cpu/memory
    
    Now that the capability to do DLPAR of cpus and memory can be
    done completely in the kernel, update the drmgr command to use
    this functionality.
    
    The kernel updates provided a sysfs file (/sys/kernel/dlpar)
    that will allow the drmgr command invoke DLPAR of cpus and memory
    by writing to this file.
    
    There are some exisitng behaviors of drmgr on the PowerVM platforms
    that require cpu and memory to be done slightly differently. For
    memory drmgr only needs to report the number of LMBs that were
    added or removed so drmgr can just pass all requests straight to
    the kernel. This patch also makes a common routine for reporting
    memory resources to ensure the format is kept constant.
    
    For cpu DLPAR the drmgr command has to report the drc name of each
    cpu that is added/removed. To do this the command uses much of the
    same device tree parsing that is currently used and make a request
    to the kernel to remove a specific cpu (by drc index) where a
    write to the sysfs probe file was previously done.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 4dafa57ec7c1498f94b324e671625b0794b92f2f
Author: Thomas Falcon <tlfalcon@linux.vnet.ibm.com>
Date:   Tue Apr 19 15:01:13 2016 -0400

    ppc64_cpu: display error message after set_smt_state_one failure
    
    This avoids a silent error if threads are unable to be onlined or offlined.
    
    Signed-off-by: Thomas Falcon <tlfalcon@linux.vnet.ibm.com>

commit 96745e9e1cb560af6f900b1dac920e36db750ee5
Author: John Allen <jallen@linux.vnet.ibm.com>
Date:   Tue Apr 19 14:52:35 2016 -0400

    lparstat: Check return value of fopen/popen before dereferencing
    
    Checks the return value of fopen and popen in several locations to make sure
    it's not null. If we pass a null file descriptor to fgets, we will hit a
    segfault.
    
    Signed-off-by: John Allen <jallen@linux.vnet.ibm.com>
    Reviewed-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>

commit 6855b92b3f9f3ed9c02065344cc98b965c3f03ef
Author: Michael Roth <mdroth@linux.vnet.ibm.com>
Date:   Tue Apr 19 14:49:43 2016 -0400

    drmgr: avoid loading rpadlpar_io/rpaphp when -v flags is used
    
    The -v / opts->pci_virtio flag was added to provide an alternative way
    to scan/remove PCI devices which doesn't rely on rpaphp. That was a
    workaround for a bug induced by QEMU emulating PHBs with multiple
    hotpluggable slots, which fails to register slots beyond the first due
    to rpaphp no longer accounting for the possibility of there being more
    than 1 slot per PHB. This leads to warnings of the form:
    
      kernel: rpaphp: pci_hp_register failed with error -16
      kernel: rpaphp: pci_hp_register failed with error -16
      ...
    
    For most guest distros this has resulted in the module not being
    loaded by default to avoid the errors showing up.
    
    However, as of a9b4e4e, we now load automatically load the module as
    needed, but we don't take opts->pci_virtio into account when
    determining if it's needed, leading to PCI hotplug operations to
    KVM guests now resulting into rpaphp being loaded and
    generating the errors above when drmgr is invoked.
    
    Fix this by avoiding modprobe of rpadlpar_io/rpaphp when
    opts->pci_virtio is set.
    
    Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>

commit efa87d93231eb0fe4f406bf58e7d5aa783ee4f13
Author: Michael Bringmann <mwb@linux.vnet.ibm.com>
Date:   Tue Apr 19 14:47:32 2016 -0400

    lparstat: Correct presentation of some stats
    
    lparstat.c: Currently there are several problems with the presentation
    of statistics by lparstat's default output mode.  These issues include:
     * Showing negative values for certain fields e.g. %user, %sys, %wait,
       %lbusy.
     * Showing zero values for certain fields e.g. physc, %entc
     * Identifying systems with 'Shared' or 'Dedicated' Memory Mode
     * Calculating the number if logical CPUs used by a system
    This patch looks to correct these issues.  It also changes the widths
    of the physc, %entc fields which had too little precision available
    to show the value change on some systems.
    
    Signed-off-by: Michael Bringmann <mwb@linux.vnet.ibm.com>

commit a27c639aca69271aabe7cac287f998b29b82f333
Author: Michael Roth <mdroth@linux.vnet.ibm.com>
Date:   Tue Apr 19 14:37:36 2016 -0400

    drmgr: ensure PCI cleanup is done before offlining dev
    
    As part of 4f542616, functionality was added to support add/remove
    PCI devices without relying on rpaphp hotplug module. The sysfs
    write used in the remove path initiates an asynchronous removal of
    PCI device from kernel PCI subsystem, and eventually from the sysfs
    tree. Afterward, we set the corresponding DRC for the device to
    ISOLATED state so host can complete device removal.
    
    To avoid the situation where the asychronous removal has not yet
    completed by the time drmgr sets the state to ISOLATED, and simple
    sleep of 3 seconds was added. This seems to have worked out okay
    for virtio devices, but in the case of other devices, like PCI
    passthrough of a Mellanox CX4 virtual function, the removal can take
    up to 20 seconds.
    
    When this happens, we hit a situation where the host reclaims the
    devices while the guest is still attempting to access it in it's
    cleanup path, which leads to guest crashes.
    
    Fix this by polling the PCI devices sysfs path and not completing
    the removal until the sysfs path is removed as part of device cleanup.
    
    Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>


powerpc-utils-1.3.1
=====================================================================
commit dccad2d1dc5c84571f31af3117095bd9ec6e34c4
Author: Brahadambal Srinivasan <latha@linux.vnet.ibm.com>
Date:   Fri Mar 25 07:46:56 2016 -0400

    snap: PowerNV platform is not correctly checked
    
    Recent patches to change from PowerKVM to PowerNV missed a
    simple change to the /usr/sbin/snap script. This patch is to
    fix that.
    
    Signed-off-by: Brahadambal Srinivasan <latha@linux.vnet.ibm.com>

commit a9b4e4ed7c6a908feb04f5b066f214ad14c76745
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Fri Mar 25 07:45:20 2016 -0400

    drmgr: Load kernel modules for pci hotplug
    
    For PHB DLPAR, slot DLPAR, and PCI hotplug operations we need to ensure
    that the rpadlpar_io and rpaphp kernel modules are loaded or have been
    built into the kernel. A check for this is currently done for PHB and
    slot DLPAR when determining if the system is capable of these operations.
    
    This patch moves the code to validate the presence of these modules
    to be called from dr_init() for PHB/SLOT/PCI operations. In order
    to do this the parsing of args has to be done prior to calling dr_init.
    This should not cause an issue since we can parse args without holding
    the dr_lock and any errors are written to stderr.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit c66dfa6338e6bb889f4806df1518642a800992ea
Author: John Allen <jallen@linux.vnet.ibm.com>
Date:   Fri Mar 25 07:43:39 2016 -0400

    lsslot: Update man page/usage statement to document required argument
    
    Update man page and usage statement for lsslot to reflect the fact that
    the -d flag requires an argument.
    
    Signed-off-by: John Allen <jallen@linux.vnet.ibm.com>

commit bd7e19a9ff5aebe741b0520906660dac1ecf4a2a
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Fri Mar 25 07:27:58 2016 -0400

    nvram: Correct valid partition name checking
    
    A recent update to not allow long names had a bug in that it did
    not correctly check the return value when verifying a partition name.
    
    Fixes: b15b0a7f9ffc (nvram: don't allow long names)
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>
    CC: Joel Stanley <joel@jms.id.au>

commit 63a362d28253e32552ff3e1e4358bfb47d69c78b
Author: Mauricio Faria de Oliveira <mauricfo@linux.vnet.ibm.com>
Date:   Thu Mar 17 20:01:06 2016 -0400

    ofpathname: Convert OF device path to logical device path for NVMe devices
    
    Add support to convert a Open Firmware device path to logical device path
    for NVMe devices (with namespace id).
    
    Signed-off-by: Mauricio Faria de Oliveira <mauricfo@linux.vnet.ibm.com>

commit bd0a574f70f2b2af39020440e6e3ed61ab5afe35
Author: Mauricio Faria de Oliveira <mauricfo@linux.vnet.ibm.com>
Date:   Thu Mar 17 19:59:51 2016 -0400

    ofpathanme: Convert logical device path to OF device path for NVMe devices
    
    Add support to convert logical device path to Open firmware device path
    for NVMe devices.
    
    Signed-off-by: Mauricio Faria de Oliveira <mauricfo@linux.vnet.ibm.com>

commit e4af95a7da425d37a6762b81d1614e648129b36a
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Feb 23 14:43:35 2016 -0500

    drmgr: free allocated hpdev in error path
    
    In error paths while allocating hpdevs in get_os_hp_devices() we
    can exit without free'ing an allocated hpdev. Move up the addition
    of the hpdev to the hpdev_list to ensure it is free'ed if an error
    occurs.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 6fcff4b41726784d9f13bdc905d7eb85f84a3248
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Feb 23 12:18:12 2016 -0500

    drmgr: close opened dir
    
    Close the directory we are traversing before returning.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit faa441c184dfa28bd5793adbd17faa7f696fc49d
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Feb 23 12:17:03 2016 -0500

    rtas_dbg: Do not exit on failure to read rtas token
    
    When gathering a list of the available rtas tokens if we are not able
    to determine the rtas token value for a token in the device tree we
    should print an error message and continue instead of exiting.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 64dd69fdc6242ec22519f1d2a18f1328825add3e
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Feb 23 12:15:53 2016 -0500

    rtas_dbg: Ensure we NULL terminate token names
    
    The current code to look up rtas tokens writes the token name
    to a static buffer size, this runs the risk of not having the
    string null terminated if the string length matches the buffer
    length.
    
    Update the code to use strdup so we can ensure the strings are
    null terminated. This also updates the free_rtas_tokens()
    routine to free the token name.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit ccc9c72cec2a4885a219958c69c35abae6cef9c4
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Feb 23 12:14:16 2016 -0500

    errinjct: Correct possible buffer overflow
    
    In multiple places in the errinjct command we read the contents of
    a file into a local buffer. This presents a possible issue if the
    file we are reading ever exceeds the size of the buffer. To prevent
    this issue a new read_file() routine is introduced that will
    allocate a buffer large enough to hold the contents of the file and
    read the file into the buffer.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit fa50467bbf0f83207055124e7bee866cbc1b612c
Merge: 39dbb91 61558c9
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Feb 15 09:03:26 2016 -0500

    Merge branch 'cyphermox-mpath' into next

commit 61558c9df4571b79c435e2d7b1157f40ae7565a3
Merge: 39dbb91 2d27304
Author: Mathieu Trudel-Lapierre <mathieu.trudel-lapierre@canonical.com>
Date:   Mon Feb 15 08:51:37 2016 -0500

    ofpathanme: map mpath* devices to the appropriate dm-* generic dm device
    
    Signed-off-by: Mathieu Trudel-Lapierre <mathieu.trudel-lapierre@canonical.co

commit 39dbb91904e0b94aa5a665d5f84dec736fdbbb07
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Feb 1 11:59:27 2016 -0500

    errinjct: Close file descriptors
    
    Properly handle file descriptors opened by ensuring
    they are closed prior to returning. Reported as a
    leaked resource by Coverity scans.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>
    Reviewed-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>

commit 07c190715a730dc98823691f18aa3b262a2bf432
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Feb 1 11:57:49 2016 -0500

    errinjct: Null terminate buffer from read()
    
    Null terminate buffers filled when calling read(). Issue uncovered
    with Coverity Scans.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 3153111b0ab6e6ae2b83c448443a3b6e3e8fe6e5
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Feb 1 11:56:02 2016 -0500

    activate_firmware: Remove use of strcat
    
    Resolve uninitialized scalar variable reported by Coverity scan.
    The 'msg' buffer was being used uninitialized in calls to strcat,
    this patch removes the use of the local 'msg' variable and puts
    the message string directly in the warnx() call.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>
    Reviewed-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>

commit f3f25d4aee3f12f0dfc6611aaab6f0819d58fe33
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Feb 1 11:53:13 2016 -0500

    ppc64_cpu: free core_state on error
    
    Make sure we free the allocated 'core_state', issue found with Coverity.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit e6f476d32c33f5b8e364f930c467785495eeb0ce
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Feb 1 11:51:55 2016 -0500

    lsslot: free lmb_list on error
    
    Free the lmb resources allocated by lsslot, Issue discovered with
    Coverity scan.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 2d27304b9e8f69619927cd2f55fb1c11c3dc5f09
Author: Mathieu Trudel-Lapierre <mathieu.trudel-lapierre@canonical.com>
Date:   Tue Jan 12 16:46:12 2016 -0500

    ofpathname: map mpath* devices to the appropriate dm-* generic dm device.
    
    Signed-off-by: Mathieu Trudel-Lapierre <mathieu.trudel-lapierre@canonical.com>

powerpc-utils-1.3.0
=====================================================================
commit ad4cf85f4bc80f6f5cbf4ce0b71eada696848081
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Thu Jan 7 15:17:41 2016 -0500

    Move the powerpc-utils package from the IBM license to the GNU GPL license.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit f037afe3bcece02ca3a3b1711a57c66db088cfa1
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Dec 1 16:36:11 2015 -0500

    drmgr: Correct checking for display adapters when adding PHB
    
    A previous commit (c2091227) added formalization for checking for display
    adapters. Unfortunately the update tries to verify if there is a display
    adapter for a NULL phb pointer when trying to add a PHB resulting in a
    segfault on phb add requests.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 85a5037cb01c1aaa5ad3dbd91f74dbcdd823dbb1
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Dec 1 16:35:04 2015 -0500

    drmgr: Remove extraneous debug output
    
    Remove extra debug statements for allocating and free'ing drc information.
    These were mistakenly left in during debug of a previous patch.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 33aa48a0c4ebc4e660080514939232ad2912cb6d
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Tue Dec 1 16:33:45 2015 -0500

    drmgr: Fix node add buffer overflow
    
    When adding a node to the device tree, the drmgr command writes a terminatin
    null in the first character past the end of the allocated buffer. This
    results in a SIGABRT being generated by libc when the buffer is free'ed.
    The fix is to move the writing of the space between properties to the
    beginning of the loop instead of at the end of the loop.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 55544a975f87e9d76366e6fefcf571ae01f3e7eb
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Nov 23 21:10:27 2015 -0500

    drmgr: Remove extraneous "d" in buffer
    
    Remove an erroneous character left in a print statement used
    to update the drconf property.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit f4006893d84c85bbf5b86919c28ba56047001204
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Nov 23 21:09:47 2015 -0500

    drmgr: Correct return code from set_mem_scn_state()
    
    The set_mem_scn_state() routine incorrectly returns the number of chars
    written in the case of success instead of returning 0. This results in the
    caller assuming a failure occurred when setting the memroy section state
    and fails the memory online/offline operation.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 4f515ea179cb36f26adb53c93b79f834e32c2abe
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Nov 23 21:08:54 2015 -0500

    drmgr: Correct LMB counting when discovering LMBs
    
    Recent updates to how drmgr counted the number of LMBs found did
    not save the count value correctly and in the case of LMBs found
    in the ibm,dynamic-reconfiguration-memory property only counted
    LMBs that were present. This caused havoc when trying to shuffle
    the LMBs.
    
    Save the LMB count in the lmb_list_head struct so we have it across
    function calls. Also update the shuffle_lmbs to just take a pointer to
    the lmb_list_head and make changes locally in the routine.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 9a1957588b040db0dddfa284dbb96a817e699792
Author: Cdric Le Goater <clg@fr.ibm.com>
Date:   Mon Nov 23 21:07:17 2015 -0500

    update_flash_nv: improve check_ipmitool
    
    This patch adds a quick test in check_ipmitool to make sure the
    BMC is alive
    
    Signed-off-by: Cdric Le Goater <clg@fr.ibm.com>

commit 4e4e5f9f8d16a2ad196d1fd5388de23aa2e1fdbc
Author: Cdric Le Goater <clg@fr.ibm.com>
Date:   Mon Nov 23 21:06:52 2015 -0500

    update_flash_nv: fix firmware update sequence for powernv
    
    This patch modifies the way the firmware update is performed from
    the host. It adds a cold reset of the BMC before and after the
    update.
    
    Signed-off-by: Cdric Le Goater <clg@fr.ibm.com>

commit 1f25105c1c7f1384be4aef03f2aa6d5bd065eb11
Author: Cdric Le Goater <clg@fr.ibm.com>
Date:   Mon Nov 23 21:06:22 2015 -0500

    update_flash_nv: force the use of the ipmitool usb backend
    
    Signed-off-by: Cdric Le Goater <clg@fr.ibm.com>

commit b0e5ba4f55dcf1a5d013eddbb95b660c65504b3c
Author: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>
Date:   Mon Nov 23 21:04:45 2015 -0500

    ppc64_cpu: output to user if the requested number of cores are not brought o
    
    Now that we check the return code from set_one_core, we should ensure
    that the requested number of cores in --cores-on is achieved, or return
    -1 intead. Also add a slightly verbose message in that case.
    
    Signed-off-by: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>

commit 1a1bb7167a3946712a5b59b5566bac6ced46cdc9
Author: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>
Date:   Mon Nov 23 21:03:37 2015 -0500

    ppc64_cpu: use rc instead of boolean flag
    
    We can overload the rc variable, reducing the number of local variables
    in do_online_cores.
    
    Signed-off-by: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>

commit 37eeba5583d48558f2ca1de6096df83494005e6f
Author: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>
Date:   Mon Nov 23 21:00:14 2015 -0500

    ppc64_cpu: check return code from set_one_core
    
    In both --cores-on and --online-cores, the return code from the helper
    function set_one_core is not checked. This can lead to ppc64_cpu
    returning 0 even though the command technically failed to do what was
    requested. After this patch, --cores-on still doesn't return a proper
    error code (fixing in a follow-on).
    
    Signed-off-by: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>

commit 9711ee00b604a39d47dfced7f0c49cf40600131f
Author: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>
Date:   Tue Nov 17 16:24:37 2015 -0500

    ppc64_cpu: add --{on,off}line-cores to {on,off}line specific cores
    
    We currently have support for a mechanism to ensure an exact number of
    cores (or all cores after a recent patch submission) are online.
    However, there is no control over which cores are selected. Add two new
    options to ppc64_cpu, --online-cores and --offline-cores to support
    specifying which cores to bring online or offline, respectively. Both
    options take either no parameters, in which case they output a
    comma-separated list of cores that are online/offline, or a
    comma-separated list of cores, in which case the command sets those
    cores' states to online/offline.
    
    Signed-off-by: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>

commit 2239dd005e00d63c6e68fe962928b5f0b08ef6cb
Author: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>
Date:   Tue Nov 17 09:33:55 2015 -0500

    ppc64_cpu: rename do_cores_online to do_cores_on
    
    This matches the other function names more closely.
    
    Signed-off-by: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>

commit bb8472f0658565e5188150a141fa8856b55000ca
Author: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>
Date:   Tue Nov 17 09:31:57 2015 -0500

    ppc64_cpu: add all parameter to --cores-on to online all cores
    
    Rather than finding out how many cores are in a system, and then passing
    that value to --cores-on, it can be handy to have a shortcut to just
    online all cores.
    
    Signed-off-by: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>

commit 17cd4bbf7c20d8096523c765c1157e4a58d31363
Author: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>
Date:   Tue Nov 17 09:29:06 2015 -0500

    ppc64_cpu: handle errors from strtol in --cores-on parsing
    
    Currently, on a 24-core system, passing certain values to `ppc64_cpu
    --cores-on` leads to some surprising results:
    
    ppc64_cpu --cores-on=all
    ppc64_cpu --cores-on=adfd
        offlines all but one core
    
    This is because we are not using the endptr parameter of strtol to
    determine if any of the string is consumed (and if none of the string is
    consumed, strtol still returns a valid long value, namely 0).
    
    ppc64_cpu --cores-on=12df
        onlines 12 cores
    
    This is because we are not using the endptr parameter to strtol to
    determine if the entire string is consumed (checking for trailing
    characters).
    
    Add both these checks.
    
    After this patch:
    
    ppc64_cpu --cores-on=all
    Invalid number of cores to online: all
    ppc64_cpu --cores-on=adfd
    Invalid number of cores to online: adfd
    ppc64_cpu --cores-on=12fd
    Invalid number of cores to online: 12fd
    
    Signed-off-by: Nishanth Aravamudan <nacc@linux.vnet.ibm.com>

commit 475919d4294819e5f890f000ccadf5b13280a0a9
Author: Chandni Verma <chandni@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:50:11 2015 -0500

    powerpc-utils.spec: Fix typo in spec-file
    
    In line:
    %{__rm} -rf $RPM_BULD_ROOT
    The directory should be RPM_BUILD_ROOT not RPM_BULD_ROOT
    
    Signed-off-by: Chandni Verma <chandni@linux.vnet.ibm.com>

commit b1d909378cf8a9502c7207f4f51a2cf3931d5263
Author: Michael Bringmann <mwb@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:48:30 2015 -0500

    errinjct/rtas_debug: Update RPM packaging specs
    
    This patch updates the powerpc-utils.spec.in file to install the binaries
    associated with errinjct and rtas_dbg.
    
    Signed-off-by: Michael Bringmann <mwb@linux.vnet.ibm.com>

commit 03704771a36c025eb8636a90f67eaa77acd5880d
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:40:47 2015 -0500

    lsslot/drmgr: Performance enhancement for parsing LMBs

    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 268116acde0d5f98efa150044b68d977d578ccb4
Author: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:39:15 2015 -0500

    errinjct: Add format specificer
    
    We hit below build warning with "-Werror=format-security" compilation option
    
     CC       src/errinjct/icache.o
     src/errinjct/errinjct.c: In function 'perr':
     src/errinjct/errinjct.c:240:18: error: format not a string literal and no f
       fprintf(stderr, buf);
                         ^
    
    Signed-off-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>

commit c2091227bdf40192a37456445a6dedf3f3da8cda
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:27:08 2015 -0500

    drmgr: Do not allow DLPAR of display adapters
    
    The DLPAR of display adapters has never been supported but that support
    has not ever been enforced in drmgr. Recent tests show that trying to DLPAR
    remove a display adapter causes the drmngr command to appear hung as it
    waits for display adapters to power down.
    
    Add the ability to check for a drc-type of 'display' when trying to add
    or remove a pci or slot, and verify that none of the children under a
    PHB are display adapters when trying to add or remove a PHB.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit aef0c5daa20f38b66e5fa0255ecf5a53ba202138
Author: Nathan Fontenot <nfont@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:26:01 2015 -0500

    drmgr: Move check for non-hotplug children to common routine
    
    In more than one place we check to see if a PHB has any children that
    are not hotplug capable. Move this code to common routine.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 2d8ad5ef33948f07e3022c601ee99cd8efc85a76
Author: Chandni Verma <chandni@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:22:19 2015 -0500

    activate_firmware: Have man page reflect the changes made in this branch
    
    -Edited description
    -added Option section
    -Added 2 new return codes 7 and 8
    
    Signed-off-by: Chandni Verma <chandni@linux.vnet.ibm.com>

commit 11041ab9e8f0e75b58d2c1a593c9c410d7a82f00
Author: Chandni Verma <chandni@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:21:02 2015 -0500

    activate_fw: Return code 8, to report a parameter error when activating firm
    
    This is a new return code mapped from rtas return code -3 which is returned 
    case of parameter error, when the utility is used without options.
    
    Signed-off-by: Chandni Verma <chandni@linux.vnet.ibm.com>

commit d1217de2906f22dbeed54f52c683f28ffcfe90c9
Author: Chandni Verma <chandni@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:19:56 2015 -0500

    activate_fw: get update access key expiry date, set update access key
    
    This patch provides two feature extensions:
    1. activate_firmware -e
       (with only -e, fetches the update access key expiry date)
    2. activate_firmware -e /path/to/keyfile
       (with an argument to -e applies the provided update access key-file to
        extend the update access key expiry date)
    
    These are required to provide an interface to check validity of and
    update the Update Access Key. ESA will be one of the users of this tool.
    
    Signed-off-by: Chandni Verma <chandni@linux.vnet.ibm.com>

commit 097c16987a65aceb0be6d66befaa0104b518abbd
Author: Chandni Verma <chandni@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:18:09 2015 -0500

    activate_fw.c: Make use of errx() to print error messages to stderr and exit
    
    This is a more compact way to do it compared to using fprintf and explicitly
    exiting in main()
    
    Signed-off-by: Chandni Verma <chandni@linux.vnet.ibm.com>

commit c2dc2191bb5963b09e781b78cbf2a152520c8e87
Author: Chandni Verma <chandni@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:17:21 2015 -0500

    activate_fw.c: Factor out activate_firmware() from main()
    
    This is done to reserve main solely for option processing and to
    abstract out rtas calling function.
    
    Signed-off-by: Chandni Verma <chandni@linux.vnet.ibm.com>

commit 72bc893a5f4b59d0e7742726e85f3cffab65ebd3
Author: Chandni Verma <chandni@linux.vnet.ibm.com>
Date:   Mon Nov 16 16:14:46 2015 -0500

    activate_fw: fix typo
    
    The default case in error handler should return code 6, not 4.
    
    Signed-off-by: Chandni Verma <chandni@linux.vnet.ibm.com>

commit 782445384c165ea28f00c9cb233e41bdeef7a962
Author: Chandni Verma <chandni@linux.vnet.ibm.com>
Date:   Mon Nov 16 15:53:42 2015 -0500

    activate_fw: Coding style fixes
    
    This patch fixes trailing white spaces and indentation issues
    and in general makes to code confirm to linux's checkpatch.pl
    
    Signed-off-by: Chandni Verma <chandni@linux.vnet.ibm.com>

commit ad93027170afe3b7bc760fed0ab3e078390ba088
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:58:44 2015 -0400

    serv_config: Compile warning cleanups
    
    Correct several compile warnings.
    
    Remove unchecked return code from execv().
    Remove unused variables.
    Correct de-reference of type punned pointers.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 8ad7081b5f1d98593c8192d4d46c10050e5b8d88
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:57:34 2015 -0400

    rtas_ibm_get_vpd: Compile warning cleanups
    
    Clean up compile warning by removing the unused lflag variable.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 28aeacd59e0e35753bae243cf63150f6ecc2a10b
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:56:32 2015 -0400

    rtas_dbg: Compile warning cleanups
    
    Correct compile errors to check the return value from a fread() call and
    add an appropriate error message, and ensuring we do not use an
    uninitialized 'rc' variable.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit dfab2e6f11a11e25da342b703bd054aaf906d818
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:55:33 2015 -0400

    ppc64_cpu: Compile warning cleanups
    
    Correct compile warning for dereference of type punned pointer.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 92fd02382fbec464562e2a84841391f09cf1e2ea
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:54:34 2015 -0400

    nvram: Compile warning cleanups
    
    Correct compile warning by removing the unused variable memctrl_data.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit f069a159755b70bf4596b2bcce5b3fb4f8c3831f
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:53:35 2015 -0400

    lparstat: Compile warning cleanups
    
    Clean up compile warnings by adding checks for the return codes from
    fgets() calls and adding appropriate error messages.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 2cc2e6590a43a367ee6ca6474bc98cc0a7245caf
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:51:59 2015 -0400

    drmgr: Compile warning cleanups
    
    Fix multiple warnings generated when compiling drmgr code. These include
    not checking return codes of fread() and write() calls where a check is
    added and appropriate error messages.
    
    Updating print formats to use the appropriate type of value being printed.
    
    Correcting the use of rc values to ensure the rc variable is set.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 0e8d1534f5bf57798b74584b6f2b42bad57ddf89
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:49:57 2015 -0400

    drmgr: Validate the status of a CPU before adding or removing it
    
    When asked to perform a CPU DLPAR operation we should verify the current
    status of the CPU before performing the operation. Failure to verify the
    status has caused the kernel to oops in cases where we try to add a CPU
    that is already owned, namely in a kvm guest the following is seen.

    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit dabc0264a9f3b64226da63421378ed02f2f1b201
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:48:25 2015 -0400

    drmgr: Add missing free's of allocated memory
    
    Using valgrind to do analysis of the memory usage of the drmgr command
    revealed multiple instances of memory not being free'ed. Correct this
    by adding appropriate calls to free commands.
    
    Note that the analysis done, and this patch, does not cover all of the code
    paths in drmgr. There may be additional patches as testing continues.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit d5a1c1bfae839e159ba049736a9719835e2a42e6
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:45:26 2015 -0400

    drmgr: Add EXTRA_DEBUG output level
    
    Introduce a new internal developer debug output level. In some cases the
    drmgr command dumps all the information about slots/adapters it gathers
    from the device tree, this is really meant for internal debugging purposes.
    Additionally, one large systems this information can easily overwhelm
    the output seen from drmgr.
    
    This patches introduces a debug level for the say() command, EXTRA_DEBUG.
    Developers can get this output by using the option '-d 5'. Several
    instances of debug output are also updated to use this new option.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit a7ebbd4bbc61cd0c7d6c3c3eea9f7ea9724558d9
Author: Nathan Fontenot <nfont@linux.vnet.ibnm.com>
Date:   Tue Oct 27 16:43:25 2015 -0400

    drmgr: free slot nodes before adding slots
    
    When handling a request for slot dlpar add the device tree is parsed twice,
    once prior to the add and again after adding the slot. On systems with a
    large number of slot devices, 200+, we are seeing that the drmgr command
    segfaults when trying to parse the device tree the second time.

    To avoid crashing here we need to free the parsed information from the
    device tree prior to adding the new slot. While this isn't really a true
    root cause fix it does alloow drmgr to run without segfaulting.
    
    Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>

commit 767e3dd780f1a18b2c832b5d8db82a5aac9a9818
Author: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
Date:   Fri Oct 16 10:01:50 2015 -0400

    update_flash: Add support for OpenPower system
    
    On OpenPower system we use IPMI interface to pass image to service processor
    (BMC) and it will take care of updating FW.
    
    This patch adds wrapper around ipmitool so that we can use update_flash
    command to update FW.
    
    Validation:
      BMC take care of validating image. We just pass the image to BMC.
    
    Commit/Reject operation:
      Like FSP system, BMC has two sides. Golden and boot side. Golden side
      is permanent and is never updated in the field. So commit/reject
      operations are not allowed on BMC based system.
    
    FW update:
      OpenPower system has two components (BMC FW and host FW). We send all
      the component to BMC in one command. BMC will take care of updating
      all the components.
      Note that we are not using "force" option. So BMC will skip the component
      which are not changed.
    
    FW version display:
      We display host FW version using ipmitool fru command. like below:
        Product Name          : OpenPOWER Firmware
        Product Version       : IBM-firestone-ibm-OP8_PFD_v1.6_0.29
        Product Extra         : hostboot-6847d73-b8d7c0a
        Product Extra         : occ-0726e69
        Product Extra         : skiboot-5.1.3-6221bd2
        Product Extra         : hostboot-binaries-43d5a59
        Product Extra         : firestone-xml-db1a93e-4ae8032
        Product Extra         : capp-ucode-105cb8f
    
    Signed-off-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>

commit 1422abed03f78866339a7b29e3eba4b2d29cb468
Author: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
Date:   Fri Oct 16 10:01:04 2015 -0400

    update_flash_nv: Add platform check
    
    Presently we assume this script is running on FSP based PowerNV platform.
    Lets add platform check to validate platform before running. That way
    adding new platform support (like OpenPower) becomes easy.
    
    Signed-off-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
    Reviewed-by: Kamalesh Babulal <kamalesh@linux.vnet.ibm.com>

commit b7d4678e0963ff4956d02188fae33cb8d5a7fe11
Author: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
Date:   Fri Oct 16 10:00:28 2015 -0400

    update_flash_nv: Rename function name to reflect platform
    
    Presently update_flash_nv supports code update on FSP based PowerNV
    (Non-Virtualized) platform. We want to support code update on OpenPower
    (BMC based) platform. Code update procedure on OpenPower system is
    different than FSP based machine. Hence rename FSP specific function
    in this script as fsp_*.
    
    Signed-off-by: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
    Reviewed-by: Kamalesh Babulal <kamalesh@linux.vnet.ibm.com>

commit a3e1c3eddb6e3486ae48dfd23f0c95c4b714322d
Author: Kamalesh Babulal <kamalesh@linux.vnet.ibm.com>
Date:   Fri Oct 16 09:59:06 2015 -0400

    snap: Warn users about deprecated support for SLES 12 onwards
    
    This patch introduce deprecated warning on SLES 12 onwards
    to use supportconfig. supportconfig captures all the information
    collected by snap, so it safe to deprecate snap.
    
    It also rearranges check for distribution (RHEL/SLES/Ubuntu) into
    common function check_distro_support().
    
    Signed-off-by: Kamalesh Babulal <kamalesh@linux.vnet.ibm.com>
    Cc: Vasant Hegde <hegdevasant@linux.vnet.ibm.com>
    Cc: Nathan Fontenot <nfont@linux.vnet.ibm.com>

